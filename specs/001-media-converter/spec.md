# 功能規格：媒體轉換工具箱

**Feature Branch**: `001-media-converter`  
**Created**: 2025-10-31  
**Status**: Draft  
**Input**: User description: "建立一個網頁應用程式，專門提供檔案格式轉換與媒體處理的核心功能"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - Base64 與圖片互轉 (Priority: P1)

使用者需要在網頁上快速將 Base64 編碼字串轉換為圖片檔案，或將圖片檔案轉換為 Base64 字串，用於前端開發、資料傳輸或文件嵌入等場景。

**Why this priority**: 這是最基礎且使用頻率最高的功能，開發者和設計師經常需要處理 Base64 圖片資料，是 MVP 的核心價值。

**Independent Test**: 可透過貼上一段有效的 Base64 字串並成功下載 PNG 圖片，或上傳一張圖片並成功複製 Base64 字串來獨立驗證。

**Acceptance Scenarios**:

1. **Given** 使用者在網頁上看到 Base64 轉圖片的輸入框，**When** 貼上有效的 Base64 字串並點擊「轉換」，**Then** 系統顯示預覽圖並提供 PNG 下載按鈕
2. **Given** 使用者看到圖片轉 Base64 的上傳區域，**When** 上傳一張圖片（PNG/JPG/GIF 等），**Then** 系統顯示圖片預覽並提供可複製的 Base64 字串
3. **Given** 使用者已成功轉換，**When** 點擊「清除」或「重置」按鈕，**Then** 所有輸入和輸出區域恢復初始狀態
4. **Given** 使用者貼上無效的 Base64 字串，**When** 點擊轉換，**Then** 系統顯示友善的錯誤訊息提示格式錯誤

---

### User Story 2 - 圖片格式轉換 (Priority: P2)

使用者需要將各種圖片格式（WebP、HEIC、SVG 等）轉換為通用的 PNG 格式，以便在不支援新格式的平台或應用程式中使用。

**Why this priority**: 隨著 WebP 和 HEIC 的普及，格式轉換需求增加，但比 Base64 轉換的使用頻率略低，適合作為第二優先功能。

**Independent Test**: 可透過上傳 WebP 或 HEIC 圖片並成功下載 PNG 格式來獨立驗證，不依賴其他功能。

**Acceptance Scenarios**:

1. **Given** 使用者在網頁上看到圖片格式轉換區域，**When** 上傳 WebP 格式圖片，**Then** 系統顯示預覽並提供 PNG 下載
2. **Given** 使用者上傳 HEIC 格式圖片，**When** 點擊轉換，**Then** 系統成功轉換為 PNG 並保持圖片品質
3. **Given** 使用者上傳 SVG 向量圖，**When** 選擇輸出尺寸並轉換，**Then** 系統將 SVG 轉為指定尺寸的 PNG
4. **Given** 使用者上傳多張不同格式圖片（批次處理），**When** 點擊批次轉換，**Then** 系統依序處理並提供批次下載
5. **Given** 使用者上傳非圖片檔案（如 PDF），**When** 嘗試轉換，**Then** 系統顯示錯誤訊息並拒絕處理

---

### User Story 3 - GIF 動畫製作 (Priority: P3)

使用者需要將影片轉換為 GIF 動畫，或將多張圖片組合成 GIF 動畫，用於社交媒體分享、文件說明或網頁展示。

**Why this priority**: GIF 製作是進階功能，使用頻率相對較低，且技術複雜度較高，適合在基礎功能穩定後再開發。

**Independent Test**: 可透過上傳一段短影片並成功產生 GIF，或上傳 3-5 張圖片並產生循環播放的 GIF 來獨立驗證。

**Acceptance Scenarios**:

1. **Given** 使用者在 GIF 製作區域，**When** 上傳一段影片檔案（MP4/MOV），**Then** 系統顯示影片預覽並提供時間範圍選擇器
2. **Given** 使用者選擇影片片段（開始/結束時間），**When** 設定畫質和幀率後點擊轉換，**Then** 系統產生 GIF 並顯示檔案大小預覽
3. **Given** 使用者選擇「圖片轉 GIF」模式，**When** 上傳 2 張以上圖片並設定每幀持續時間，**Then** 系統產生循環播放的 GIF
4. **Given** 使用者調整 GIF 參數（幀率、尺寸、循環次數），**When** 重新產生，**Then** 新的 GIF 反映參數變更
5. **Given** 產生的 GIF 檔案過大（超過 10MB），**When** 轉換完成，**Then** 系統提示檔案大小並建議降低畫質或尺寸

---

### Edge Cases

- **無效輸入處理**：當使用者貼上非 Base64 字串、上傳損壞的圖片、或提供不支援的檔案格式時，系統如何提示？
- **檔案大小限制**：當使用者上傳超大檔案（例如 50MB 影片或 100MB 圖片）時，系統是否限制並提示？
- **瀏覽器相容性**：在舊版瀏覽器（不支援 File API 或 Canvas API）上，系統如何降級或提示？
- **記憶體不足**：當使用者在低配置設備上處理大量圖片或長影片時，系統如何避免瀏覽器崩潰？
- **網路中斷**：由於是本地處理，網路中斷不影響功能，但如何確保使用者了解這是本地工具？
- **隱私保護**：如何明確告知使用者所有處理都在本地進行，檔案不會上傳到伺服器？
- **輸出品質**：當 SVG 轉 PNG 或影片轉 GIF 時，如何在檔案大小和品質之間取得平衡？

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 系統必須支援 Base64 字串貼上並轉換為 PNG 圖片
- **FR-002**: 系統必須支援圖片上傳（PNG、JPG、GIF、WebP、HEIC、SVG）並轉換為 Base64 字串
- **FR-003**: 系統必須支援將 WebP、HEIC、SVG 圖片格式轉換為 PNG 格式
- **FR-004**: 系統必須支援批次處理多張圖片的格式轉換
- **FR-005**: 系統必須支援影片檔案（MP4、MOV、WebM）上傳並轉換為 GIF 動畫
- **FR-006**: 系統必須支援多張圖片上傳並組合成 GIF 動畫
- **FR-007**: 系統必須提供 GIF 參數調整功能（幀率、尺寸、循環次數、時間範圍）
- **FR-008**: 系統必須提供轉換結果的即時預覽功能
- **FR-009**: 系統必須提供下載按鈕以儲存轉換後的檔案
- **FR-010**: 系統必須在瀏覽器本地端處理所有轉換，不上傳檔案至伺服器
- **FR-011**: 系統必須在無效輸入時顯示明確的錯誤訊息
- **FR-012**: 系統必須限制單一檔案上傳大小以避免瀏覽器崩潰
- **FR-013**: 系統必須提供清除/重置功能以清空當前操作狀態
- **FR-014**: 系統必須顯示處理進度指示器（對於耗時操作如影片轉 GIF）
- **FR-015**: 系統必須在轉換完成後顯示輸出檔案的大小資訊

### Key Entities

- **轉換任務 (Conversion Task)**: 代表單次轉換操作，包含輸入檔案/資料、轉換類型、輸出設定、處理狀態
- **圖片檔案 (Image File)**: 代表輸入或輸出的圖片，包含格式、尺寸、品質、二進位資料
- **影片檔案 (Video File)**: 代表輸入的影片，包含格式、時長、解析度、幀率
- **GIF 參數 (GIF Parameters)**: 代表 GIF 產生的設定，包含幀率、尺寸、循環次數、時間範圍、品質等級
- **Base64 資料 (Base64 Data)**: 代表 Base64 編碼字串及其對應的圖片格式資訊

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 使用者可在 2 秒內完成 Base64 與圖片的單次轉換（檔案小於 5MB）
- **SC-002**: 使用者可在 5 秒內完成單張圖片的格式轉換（檔案小於 10MB）
- **SC-003**: 使用者可在 30 秒內完成 10 秒影片轉 GIF 的操作（標準畫質設定）
- **SC-004**: 系統支援至少 20MB 的圖片檔案處理而不崩潰
- **SC-005**: 系統在無網路連線狀態下仍可正常運作所有功能
- **SC-006**: 90% 的使用者在第一次使用時即可成功完成核心功能（Base64 轉換）
- **SC-007**: 所有轉換操作的錯誤訊息清晰明確，使用者無需技術知識即可理解
- **SC-008**: 轉換後的 PNG 圖片品質與原始檔案視覺上無明顯差異
- **SC-009**: GIF 檔案大小控制在合理範圍內（10 秒影片轉 GIF 不超過 5MB，標準畫質）
- **SC-010**: 使用者隱私受保護，所有處理在瀏覽器本地端完成，無任何資料上傳

## Assumptions *(合理預設)*

- **瀏覽器支援**: 假設使用者使用現代瀏覽器（Chrome 90+, Firefox 88+, Safari 14+, Edge 90+），支援 File API、Canvas API、Web Workers
- **檔案大小**: 預設單一檔案上傳限制為 50MB（圖片）和 100MB（影片），可依實際測試調整
- **輸出格式**: Base64 轉圖片固定輸出 PNG 格式，其他格式轉換也固定輸出 PNG
- **GIF 品質**: 預設 GIF 幀率為 10 FPS，尺寸為原始尺寸的 80%，循環次數為無限
- **錯誤處理**: 所有錯誤訊息使用繁體中文顯示，提供明確的操作建議
- **隱私聲明**: 在網頁顯眼位置標示「所有處理在本地進行，檔案不上傳」以建立信任
- **效能目標**: 假設使用者設備為中階電腦/手機（8GB RAM, 雙核心處理器），不針對低階設備優化
